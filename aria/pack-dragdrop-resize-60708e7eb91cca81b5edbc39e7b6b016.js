/*
 * Aria Templates 1.3.5 - 05 Feb 2013
 *
 * Copyright 2009-2013 Amadeus s.a.s.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
//***MULTI-PART
//*******************
//LOGICAL-PATH:aria/utils/dragdrop/Drag.js
//*******************
(function(){function e(e,t,n){e&&e.setAttribute(t,n)}function t(e,t){e&&e.removeAttribute(t)}var n=0;Aria.classDefinition({$classpath:"aria.utils.dragdrop.Drag",$dependencies:["aria.utils.Dom","aria.utils.Mouse","aria.utils.Type"],$implements:["aria.utils.dragdrop.IDrag"],$statics:{INVALID_ATTRIBUTE:"Invalid attribute '%1' in '%2'"},$constructor:function(t,n){n=n||{},this.id=null,this.element=null;var r=aria.utils.Type;r.isString(t)?this.id=t:r.isHTMLElement(t)?(this.element=t,this.id=this.element.id):(this.
$logError(this.INVALID_ATTRIBUTE,["id","constructor"]),this.start=Aria.empty,this.move=Aria.empty,this.end=Aria.empty),this.params=n,this.handle=n.handle,this.cursor=n.cursor,this.originalCursor=null,this.proxy=null,this.posX=null,this.posY=null,this._boundary=null,this._horizontal=n.axis&&n.axis=="x",this._vertical=n.axis&&n.axis=="y",this._elementInitialPosition=null,this._movableInitialGeometry=null,this._movableGeometry=null,this._baseMovableOffset=null,this.listenerId=aria.utils.Mouse.listen("drag",this
),e(this.getDraggable(!0),aria.utils.Mouse.DRAGGABLE_ATTRIBUTE,this.listenerId),this.getMovable(!1)},$destructor:function(){var e=this.getDraggable();e&&(t(e,aria.utils.Mouse.DRAGGABLE_ATTRIBUTE),e.style.cursor=this.originalCursor,e=null),this.proxy&&this.proxy.overlay&&this.proxy.$dispose(),this.element=null,this.handle=null,this.cursor=null,this.proxy=null,aria.utils.Mouse.stopListen("drag",this)},$prototype:{getDraggable:function(e){var t=this.handle,n=this.cursor,r;if(!t)r=this.getElement(e);else{var i=aria
.utils.Type;i.isString(t)&&(t=aria.utils.Dom.getElementById(t)),i.isHTMLElement(t)?(this.handle=t,r=t):e===!0&&this.$logError(this.INVALID_ATTRIBUTE,["handle","params"])}if(r)return n&&(this.originalCursor==null&&(this.originalCursor=r.style.cursor),r.style.cursor=n),r},getElement:function(e){var t=this.element;if(!t){t=aria.utils.Dom.getElementById(this.id);if(!t){e===!0&&this.$logError(this.INVALID_ATTRIBUTE,["id","constructor"]);return}this.element=t}return t},_setElementStyle:function(e){var t=e.style,n=
{left:e.offsetLeft,top:e.offsetTop};this._elementInitialPosition=n,t.position="absolute",t.left=n.left+"px",t.top=n.top+"px"},getMovable:function(e){var t=this.proxy;if(t)return t.overlay;var n=this.params,r=n.proxy;if(r){var i="aria.utils.overlay."+r.type;return Aria.load({classes:[i],oncomplete:e===!1?null:{fn:this._createProxy,scope:this,args:{classpath:i,cfg:r.cfg}},onerror:{fn:function(){this.$logError(this.INVALID_ATTRIBUTE,["proxy","params"])},scope:this,override:!0}}),e!==!1&&!this.proxy&&(this.proxy=
{}),this.proxy?this.proxy.overlay:this.proxy}return this.getElement()},_createProxy:function(e){var t=Aria.getClassRef(e.classpath);try{var r=e.cfg||{};r.id=this.id||"proxy_"+n,n++,this.proxy=new t(this.getElement(),r)}catch(i){this.$logError(this.INVALID_ATTRIBUTE,["proxy","params"])}},start:function(e){this.posX=e.x,this.posY=e.y;var t=this.getElement(!0),n;t.onselectstart=Aria.returnFalse,this._setElementStyle(t),this._setBoundary();var r=this.getMovable();r&&(r.onselectstart=Aria.returnFalse,r.offsetTop<
t.offsetTop&&(r.style.top=t.offsetTop+"px"),this._movableInitialGeometry=aria.utils.Dom.getGeometry(r),this._movableGeometry=aria.utils.Json.copy(this._movableInitialGeometry),n=r.offsetParent,this._movableGeometry.y+=n.scrollTop>0?n.scrollTop:0,this._baseMovableOffset={left:this._movableGeometry.x-r.offsetLeft,top:this._movableGeometry.y-r.offsetTop},this.$raiseEvent("dragstart"))},move:function(e){var t=this.getMovable(),n=aria.utils.Dom;if(t&&t.style){var r=this._vertical?0:e.clientX-this.posX,i=this._horizontal?0
:e.clientY-this.posY,s=aria.utils.Json.copy(this._movableGeometry);s.x+=r,s.y+=i;var o=this._boundary?n.fitInside(s,this._boundary):{top:s.y,left:s.x};t.style.top=o.top-this._baseMovableOffset.top+"px",t.style.left=o.left-this._baseMovableOffset.left+"px",s.y=o.top,s.x=o.left,this.posY+=s.y-this._movableGeometry.y,this.posX+=s.x-this._movableGeometry.x,this._movableGeometry=s,this.$raiseEvent("move")}},end:function(){var e=this.getElement(),t=e.offsetParent;e.onselectstart=Aria.returnTrue,this.proxy&&this.proxy
.overlay&&(this._movableInitialGeometry.y+=t.scrollTop>0?t.scrollTop:0,e.style.top=this._elementInitialPosition.top+this._movableGeometry.y-this._movableInitialGeometry.y+"px",e.style.left=this._elementInitialPosition.left+this._movableGeometry.x-this._movableInitialGeometry.x+"px",this.proxy.$dispose(),this.proxy=null),this.$raiseEvent("dragend")},_setBoundary:function(){var e=this.params.constrainTo,t=aria.utils.Dom;if(!e||e===t.VIEWPORT){this._boundary=e;return}aria.utils.Type.isString(e)&&(e=t.getElementById
(e));if(e){this._boundary=aria.utils.Dom.getGeometry(e);return}this._boundary=null,this.$logError(this.INVALID_ATTRIBUTE,["constrainTo","params"])}}})})();
//*******************
//LOGICAL-PATH:aria/utils/dragdrop/DragDropBean.js
//*******************
Aria.beanDefinitions({$package:"aria.utils.dragdrop.DragDropBean",$description:"",$namespaces:{json:"aria.core.JsonTypes"},$beans:{DragCfg:{$type:"json:Object",$description:"",$properties:{handle:{$type:"json:MultiTypes",$description:"",$contentTypes:[{$type:"json:String",$description:""},{$type:"json:ObjectRef",$description:""}]},cursor:{$type:"json:String",$description:""},proxy:{$type:"ProxyCfg",$description:""},constrainTo:{$type:"json:MultiTypes",$description:"",$contentTypes:[{$type:"json:String",$description
:""},{$type:"json:String",$description:""},{$type:"json:ObjectRef",$description:""}]},axis:{$type:"json:Enum",$description:"",$enumValues:["x","y"]}}},ProxyCfg:{$type:"json:Object",$description:"",$properties:{type:{$type:"json:Enum",$description:"",$enumValues:["Overlay","CloneOverlay"]},cfg:{$type:"json:ObjectRef",$description:""}}}}});
//*******************
//LOGICAL-PATH:aria/utils/dragdrop/IDrag.js
//*******************
Aria.interfaceDefinition({$classpath:"aria.utils.dragdrop.IDrag",$interface:{start:{$type:"Function"},move:{$type:"Function"},end:{$type:"Function"}},$events:{dragstart:"Occurs when the user starts drag operation",move:"Occurs when the user moves the draggable element",dragend:"Occurs when the user ends drag operation",beforeresize:"Occurs when the user starts resize operation",resize:"occurs when the user resizing element",resizeend:"Occurs when the user ends resize"}});
//*******************
//LOGICAL-PATH:aria/utils/resize/Resize.js
//*******************
Aria.classDefinition({$classpath:"aria.utils.resize.Resize",$extends:"aria.utils.dragdrop.Drag",$dependencies:["aria.utils.Dom","aria.utils.String","aria.utils.Json"],$constructor:function(e,t){t=t||{};var n={type:"Overlay"},r=e,i=this;this.minHeight=100,this.minWidth=100,this.$Drag.constructor.call(i,r,{handle:t.handle,cursor:t.cursor,proxy:n,axis:t.axis,constrainTo:aria.utils.Dom.VIEWPORT})},$destructor:function(){this.$Drag.$destructor.call(this),this.minHeight=null,this.minWidth=null},$prototype:{start:function(
e){this.posX=e.x,this.posY=e.y;var t=this.getElement(!0),n,r=Aria.$window.document;t.onselectstart=Aria.returnFalse,r.onselectstart=Aria.returnFalse,this._setElementStyle(t),this._setBoundary(),n=this.getMovable(),n&&(n.onselectstart=Aria.returnFalse,this._movableInitialGeometry=aria.utils.Dom.getGeometry(n),this._movableGeometry=aria.utils.Json.copy(this._movableInitialGeometry),this._baseMovableOffset={left:this._movableGeometry.x-n.offsetLeft,top:this._movableGeometry.y-n.offsetTop,height:this._movableGeometry
.height-n.offsetHeight,width:this._movableGeometry.width-n.offsetWidth},this.$raiseEvent("beforeresize"))},move:function(e){var t=this.getMovable();if(t&&t.style){var n=this._vertical?0:e.clientX-this.posX,r=this._horizontal?0:e.clientY-this.posY,i=aria.utils.Json.copy(this._movableGeometry),s,o;i=this._resizeWitHandlers(i,this.cursor,n,r);var u=/sw-resize|nw-resize|w-resize/.test(this.cursor),a=/nw-resize|ne-resize|n-resize/.test(this.cursor),f=i.width<this.minWidth,l=i.height<this.minHeight;f&&(i.width=this
.minWidth),l&&(i.height=this.minHeight),s=this._movableGeometry.x+this._movableGeometry.width,o=this._movableGeometry.y+this._movableGeometry.height,f&&u&&(i.x=s-this.minWidth),l&&a&&(i.y=o-this.minHeight),t.style.cursor=this.cursor,t.style.top=i.y-this._baseMovableOffset.top+"px",t.style.left=i.x-this._baseMovableOffset.left+"px",t.style.height=i.height-this._baseMovableOffset.height+"px",t.style.width=i.width-this._baseMovableOffset.width+"px",this._movableGeometry=i,this.$raiseEvent("resize")}},end:function(
){var e=this.getElement();e.onselectstart=Aria.returnTrue,this.proxy&&this.proxy.overlay&&(e.style.top=this._elementInitialPosition.top+this._movableGeometry.y-this._movableInitialGeometry.y+"px",e.style.left=this._elementInitialPosition.left+this._movableGeometry.x-this._movableInitialGeometry.x+"px",e.style.height=this._elementInitialPosition.height+this._movableGeometry.height-this._movableInitialGeometry.height+"px",e.style.width=this._elementInitialPosition.width+this._movableGeometry.width-this._movableInitialGeometry
.width+"px",this.proxy.$dispose(),this.proxy=null),this.$raiseEvent("resizeend")},_resizeWitHandlers:function(e,t,n,r){var e=aria.utils.Json.copy(e),i=aria.utils.String.trim;t=i(t);var s=e.width>=this.minWidth?n:0,o=e.height>=this.minHeight?r:0;switch(t){case"n-resize":e.y+=o,e.height-=o,e=this._fitResizeBoundary(e),this.posY+=e.y-this._movableGeometry.y;break;case"ne-resize":e.y+=o,e.height-=o,e.width+=s,e=this._fitResizeBoundary(e),this.posX+=s,this.posY+=e.y-this._movableGeometry.y;break;case"nw-resize":e
.x+=s,e.y+=o,e.height-=o,e.width-=s,e=this._fitResizeBoundary(e),this.posX+=e.x-this._movableGeometry.x,this.posY+=e.y-this._movableGeometry.y;break;case"s-resize":e.height+=o,e=this._fitResizeBoundary(e),this.posY+=o;break;case"se-resize":e.height+=o,e.width+=s,e=this._fitResizeBoundary(e),this.posY+=o,this.posX+=s;break;case"sw-resize":e.x+=s,e.height+=o,e.width-=s,e=this._fitResizeBoundary(e),this.posY+=o,this.posX+=e.x-this._movableGeometry.x;break;case"e-resize":e.width+=s,e=this._fitResizeBoundary(e),this
.posX+=s;break;case"w-resize":e.x+=s,e.width-=s,e=this._fitResizeBoundary(e),this.posX+=e.x-this._movableGeometry.x}return e},_fitResizeBoundary:function(e){var t=aria.utils.Dom,n=this._boundary?t.fitInside(e,this._boundary):{top:e.y,left:e.x};return e.x=n.left,e.y=n.top,e},_setElementStyle:function(e){var t=e.style,n={left:e.offsetLeft,top:e.offsetTop,height:e.offsetHeight,width:e.offsetWidth};this._elementInitialPosition=n,t.position="absolute",t.left=n.left+"px",t.top=n.top+"px",t.height=n.height+"px",t.width=
n.width+"px"}}});